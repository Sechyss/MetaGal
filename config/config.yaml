# ── Pipeline configuration ────────────────────────────────────────────────────
#
# Copy this file, adjust the paths and parameters for your project,
# then run:
#
#   python pipeline.py --config config/config.yaml
#
# All paths can be relative to the working directory or absolute.
# ─────────────────────────────────────────────────────────────────────────────

# Root directory for all pipeline outputs
output_dir: results

# Number of CPU threads available for tools that support parallelism
threads: 4

# Sequencing platform: illumina (paired-end) or nanopore (single-end)
# Defaults to illumina if omitted.
sequencing_platform: illumina

# ── Samples ───────────────────────────────────────────────────────────────────
# Illumina – Option A: inline list (r1 + r2 paired-end reads)
samples:
  sample_01:
    r1: data/raw/sample_01_R1.fastq.gz
    r2: data/raw/sample_01_R2.fastq.gz
  sample_02:
    r1: data/raw/sample_02_R1.fastq.gz
    r2: data/raw/sample_02_R2.fastq.gz

# Illumina – Option B: TSV manifest (comment out the inline list above and uncomment below)
# samples: data/manifest.tsv   # columns: sample, r1, r2

# Nanopore – Option A: inline list (single reads per sample)
# sequencing_platform: nanopore
# samples:
#   sample_01:
#     reads: data/raw/sample_01.fastq.gz
#   sample_02:
#     reads: data/raw/sample_02.fastq.gz

# Nanopore – Option B: TSV manifest
# samples: data/manifest_nanopore.tsv   # columns: sample, reads

# ── Sample metadata ───────────────────────────────────────────────────────────
# TSV file with sample identifiers as the first column.
# Required for diversity plots and statistical tests.
metadata: data/metadata.tsv

# Metadata column to use for grouping samples in plots
group_column: treatment

# ── Steps to run ──────────────────────────────────────────────────────────────
# Set any step to false to skip it.
steps:
  quality_control: true
  trimming: true
  denoising: true
  taxonomy: true
  diversity: true
  visualisation: true

# ── Primer trimming ───────────────────────────────────────────────────────────
# Illumina (cutadapt):
trimming:
  # Built-in primer sets: 515F_806R (V4), 27F_338R (V1-V2), 341F_806R (V3-V4)
  primer_set: 515F_806R

  # Override with custom primers (leave empty to use primer_set above)
  # forward_primer: GTGYCAGCMGCCGCGGTAA
  # reverse_primer: GGACTACNVGGGTWTCTAAT

  min_length: 100          # discard reads shorter than this after trimming
  error_rate: 0.1          # maximum allowed primer mismatch rate
  discard_untrimmed: true  # discard read pairs without detected primers

# Nanopore (NanoFilt + optional cutadapt):
# trimming:
#   min_length: 200        # minimum read length to keep
#   max_length: 2000       # maximum read length (omit for no upper limit)
#   min_quality: 8.0       # minimum mean Phred quality score
#   primer_set: 515F_806R  # optional: remove primers after NanoFilt

# ── DADA2 denoising ───────────────────────────────────────────────────────────
# Illumina (paired-end):
dada2:
  trunc_len_f: 230   # truncate forward reads at this position
  trunc_len_r: 200   # truncate reverse reads at this position

# Nanopore (single-end):
# dada2:
#   trunc_len: 0     # 0 = no truncation (recommended for Nanopore)

# ── Taxonomic classification ──────────────────────────────────────────────────
taxonomy:
  # Method: vsearch (global alignment) or qiime2 (Naive Bayes classifier)
  method: vsearch

  # VSEARCH: path to a SILVA or GreenGenes FASTA database with taxonomy headers
  database: data/silva_138_99_seqs.fasta

  # VSEARCH: minimum identity for a hit to be accepted
  identity: 0.97

  # QIIME 2: path to pre-trained classifier artefact (.qza)
  # classifier: data/silva-138-99-nb-classifier.qza

# ── Visualisation ─────────────────────────────────────────────────────────────
# Taxonomic level for relative abundance bar chart
taxonomy_level: Phylum   # Domain, Phylum, Class, Order, Family, Genus, Species

# Number of top taxa to show (remainder merged into "Other")
top_n_taxa: 10
